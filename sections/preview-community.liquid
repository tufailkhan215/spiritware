{% comment %} Spiritware preview community: testimonial slider (image + quote + author), prev/next + dots. {% endcomment %}
<section class="preview-community preview-theme" id="community">
  <div class="preview-section preview-community__inner">
    <header class="preview-community__header">
      {% if section.settings.label != blank %}
        <span class="preview-label preview-community__label">{{ section.settings.label }}</span>
      {% endif %}
      {% if section.settings.heading != blank %}
        <h2 class="preview-heading-serif preview-heading-lg preview-community__heading">{{ section.settings.heading }}</h2>
      {% endif %}
    </header>
    <div class="preview-community__slider" data-preview-testimonial-slider>
      {% for block in section.blocks %}
        {% if block.type == 'testimonial' %}
          <div class="preview-community__slide" data-slide {% if forloop.first %}data-active{% endif %} {{ block.shopify_attributes }}>
            <div class="preview-community__grid">
              <div class="preview-community__media">
                {% if block.settings.image != blank %}
                  <img src="{{ block.settings.image | image_url: width: 600 }}" alt="{{ block.settings.author | default: 'Testimonial' | escape }}" class="preview-community__image" width="600" loading="lazy">
                {% else %}
                  <div class="preview-community__placeholder"></div>
                {% endif %}
                <div class="preview-community__quote-icon" aria-hidden="true">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z"></path><path d="M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z"></path></svg>
                </div>
              </div>
              <div class="preview-community__content">
                {% if block.settings.quote != blank %}
                  <blockquote class="preview-community__quote">{{ block.settings.quote }}</blockquote>
                {% endif %}
                <div class="preview-community__author">
                  {% if block.settings.author != blank %}<p class="preview-community__author-name">{{ block.settings.author }}</p>{% endif %}
                  {% if block.settings.location != blank %}<p class="preview-community__author-location">{{ block.settings.location }}</p>{% endif %}
                </div>
              </div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>
    {% if section.blocks.size > 1 %}
      <div class="preview-community__nav" data-preview-testimonial-nav>
        <button type="button" class="preview-community__nav-btn" data-prev aria-label="{{ 'general.pagination.previous' | t }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"></path></svg>
        </button>
        <div class="preview-community__dots" data-dots></div>
        <button type="button" class="preview-community__nav-btn" data-next aria-label="{{ 'general.pagination.next' | t }}">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"></path></svg>
        </button>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Preview Community",
  "class": "section-preview-community",
  "settings": [
    { "type": "text", "id": "label", "label": "Label", "default": "The Tribe Speaks" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Community Voices" }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "textarea", "id": "quote", "label": "Quote" },
        { "type": "text", "id": "author", "label": "Author name" },
        { "type": "text", "id": "location", "label": "Location" }
      ]
    }
  ],
  "presets": [
    { "name": "Preview Community", "blocks": [{ "type": "testimonial" }] }
  ]
}
{% endschema %}
