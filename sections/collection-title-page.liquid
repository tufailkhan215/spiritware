{% comment %}
  Title Page (collection hero): full-width image background, gradient overlay,
  left-aligned label, heading, description, and CTA button.
  Optional: use collection image/title/description when on a collection template.
{% endcomment %}

{%- assign use_collection = section.settings.use_collection_details -%}
{%- assign bg_image = section.settings.background_image -%}
{%- assign label = section.settings.label -%}
{%- assign heading = section.settings.heading -%}
{%- assign description = section.settings.description -%}
{%- assign button_text = section.settings.button_text -%}
{%- assign button_url = section.settings.button_url | default: '#' -%}

{%- if use_collection and collection != blank -%}
  {%- if bg_image == blank and collection.image != blank -%}
    {%- assign bg_image = collection.image -%}
  {%- endif -%}
  {%- if heading == blank -%}
    {%- assign heading = collection.title -%}
  {%- endif -%}
  {%- if description == blank and collection.description != blank -%}
    {%- assign description = collection.description | strip_html | truncatewords: 30 -%}
  {%- endif -%}
  {%- if button_url == '#' or button_url == blank -%}
    {%- assign button_url = collection.url -%}
  {%- endif -%}
{%- endif -%}

<section
  class="collection-title-page"
  data-section-id="{{ section.id }}"
  aria-label="{{ heading | default: 'Collection' }}"
>
  <div class="collection-title-page__bg">
    {%- if bg_image != blank -%}
      <img
        src="{{ bg_image | image_url: width: 1920 }}"
        alt="{{ heading | default: bg_image.alt | escape }}"
        class="collection-title-page__image"
        width="1920"
        height="1080"
        loading="eager"
        fetchpriority="high"
      >
    {%- else -%}
      <div class="collection-title-page__placeholder">{{ 'lifestyle-1' | placeholder_svg_tag: 'collection-title-page__placeholder-svg' }}</div>
    {%- endif -%}
    <div class="collection-title-page__gradient" aria-hidden="true"></div>
  </div>

  <div class="collection-title-page__inner">
    <div class="collection-title-page__content">
      {%- if label != blank -%}
        <span class="collection-title-page__label">{{ label }}</span>
      {%- endif -%}
      {%- if heading != blank -%}
        <h1 class="collection-title-page__heading">{{ heading }}</h1>
      {%- endif -%}
      {%- if description != blank -%}
        <p class="collection-title-page__desc">{{ description }}</p>
      {%- endif -%}
      {%- if button_text != blank -%}
        <a href="{{ button_url }}" class="collection-title-page__btn">
          {{ button_text }}
          <svg class="collection-title-page__btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path></svg>
        </a>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Title Page",
  "tag": "section",
  "class": "collection-title-page-section",
  "settings": [
    {
      "type": "header",
      "content": "Background"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "checkbox",
      "id": "use_collection_details",
      "label": "Use collection details on collection pages",
      "default": false,
      "info": "When on a collection page, use that collection's image, title, and description if the fields below are left blank."
    },
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "Spiritually Armed & Dangerously Aligned"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "God Squad"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "For the warriors of light who claim their divine backup without apology."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Shop Collection"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button link"
    }
  ],
  "presets": [
    {
      "name": "Title Page",
      "settings": {
        "label": "Spiritually Armed & Dangerously Aligned",
        "heading": "God Squad",
        "description": "For the warriors of light who claim their divine backup without apology.",
        "button_text": "Shop Collection"
      }
    }
  ]
}
{% endschema %}
