<div class="instagram-feed section page-width" style="padding: 4rem 0; background: #1c1917; color: #fff;">
  <header class="instagram-feed__header" style="text-align: center; margin-bottom: 2rem;">
    <span class="instagram-feed__handle" style="display: inline-flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; color: #a8a29e;">
      <span aria-hidden="true">üì∑</span>
      {% if section.settings.instagram_handle != blank %}
        @{{ section.settings.instagram_handle }}
      {% endif %}
    </span>
    {% if section.settings.heading != blank %}
      <h2 class="instagram-feed__heading" style="font-size: 2rem; margin: 0.5rem 0; color: #fff;">{{ section.settings.heading }}</h2>
    {% endif %}
    {% if section.settings.description != blank %}
      <p class="instagram-feed__description" style="margin: 0; color: #a8a29e; max-width: 40rem; margin-left: auto; margin-right: auto;">{{ section.settings.description }}</p>
    {% endif %}
  </header>

  <div class="instagram-feed__grid" style="display: grid; gap: 0.5rem; grid-template-columns: repeat(2, 1fr);">
    {% for block in section.blocks %}
      {% if block.type == 'image' %}
        <a href="{{ block.settings.link }}" class="instagram-feed__item" {{ block.shopify_attributes }} style="position: relative; display: block; aspect-ratio: 1; overflow: hidden; border-radius: 0.5rem;">
          {% if block.settings.image != blank %}
            <img src="{{ block.settings.image | image_url: width: 400 }}" alt="" loading="lazy" style="width: 100%; height: 100%; object-fit: cover;" />
          {% else %}
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
          {% endif %}
          <span class="instagram-feed__overlay" style="position: absolute; inset: 0; background: rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center; gap: 0.5rem; opacity: 0; transition: opacity 0.3s;">
            <span aria-hidden="true">‚ù§Ô∏è</span>
            {% if block.settings.like_count != blank %}
              <span class="instagram-feed__likes">{{ block.settings.like_count }}</span>
            {% endif %}
          </span>
        </a>
      {% endif %}
    {% endfor %}
  </div>

  {% if section.settings.instagram_handle != blank %}
    <p class="instagram-feed__cta" style="text-align: center; margin-top: 2rem;">
      <a href="{{ section.settings.instagram_url }}" target="_blank" rel="noopener" class="button button--primary">{{ 'sections.instagram.follow' | t: handle: section.settings.instagram_handle }}</a>
    </p>
  {% endif %}
</div>

{% schema %}
{
  "name": "Instagram feed",
  "class": "section-instagram-feed",
  "settings": [
    {
      "type": "text",
      "id": "instagram_handle",
      "label": "Instagram handle"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "url",
      "id": "instagram_url",
      "label": "Instagram URL"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "text",
          "id": "like_count",
          "label": "Like count (shown on hover)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Instagram feed",
      "blocks": [
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" },
        { "type": "image" }
      ]
    }
  ]
}
{% endschema %}
