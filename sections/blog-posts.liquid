{% schema %}
{
  "name": "Blog Posts",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "label": "Label",
      "default": "Get Inspired"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "CA89 Blog"
    },
    {
      "type": "blog",
      "id": "blog",
      "label": "Blog"
    },
    {
      "type": "range",
      "id": "posts_to_show",
      "label": "Posts to show",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 3
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All Posts Link"
    }
  ],
  "presets": [
    {
      "name": "Blog Posts"
    }
  ]
}
{% endschema %}

<section class="blog-posts-section">
  <div class="blog-posts-container">
    <div class="blog-posts-header">
      <div class="blog-posts-header-content">
        {%- if section.settings.label != blank -%}
          <span class="blog-posts-label">{{ section.settings.label }}</span>
        {%- endif -%}
        {%- if section.settings.heading != blank -%}
          <h2 class="blog-posts-heading">{{ section.settings.heading }}</h2>
        {%- endif -%}
      </div>
      {%- if section.settings.view_all_link != blank -%}
        <a href="{{ section.settings.view_all_link }}" class="blog-posts-view-all">
          View All Posts
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="blog-posts-view-all-arrow" aria-hidden="true">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </a>
      {%- endif -%}
    </div>

    {%- if section.settings.blog != blank -%}
      {%- assign blog_handle = section.settings.blog -%}
      {%- assign posts_limit = section.settings.posts_to_show | default: 3 -%}
      {%- assign blog_articles = blogs[blog_handle].articles -%}
      
      {%- if blog_articles.size > 0 -%}
        <div class="blog-posts-grid">
          {%- for article in blog_articles limit: posts_limit -%}
            <a href="{{ article.url }}" class="blog-post-card">
              <div class="blog-post-image-wrapper">
                {%- if article.image != blank -%}
                  <img 
                    src="{{ article.image | image_url: width: 1200 }}" 
                    alt="{{ article.title }}" 
                    class="blog-post-image"
                    loading="lazy"
                  >
                {%- else -%}
                  <div class="blog-post-image-placeholder">
                    {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                  </div>
                {%- endif -%}
                <div class="blog-post-image-overlay"></div>
                <div class="blog-post-date">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="blog-post-calendar-icon" aria-hidden="true">
                    <path d="M8 2v4"></path>
                    <path d="M16 2v4"></path>
                    <rect width="18" height="18" x="3" y="4" rx="2"></rect>
                    <path d="M3 10h18"></path>
                  </svg>
                  {{ article.published_at | date: "%b %d, %Y" }}
                </div>
              </div>
              <div class="blog-post-content">
                <h3 class="blog-post-title">{{ article.title }}</h3>
                {%- if article.excerpt != blank -%}
                  <p class="blog-post-excerpt">{{ article.excerpt | strip_html | truncatewords: 20 }}</p>
                {%- elsif article.content != blank -%}
                  <p class="blog-post-excerpt">{{ article.content | strip_html | truncatewords: 20 }}</p>
                {%- endif -%}
                <span class="blog-post-read-more">
                  Read More
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="blog-post-read-more-arrow" aria-hidden="true">
                    <path d="M5 12h14"></path>
                    <path d="m12 5 7 7-7 7"></path>
                  </svg>
                </span>
              </div>
            </a>
          {%- endfor -%}
        </div>
      {%- endif -%}
    {%- endif -%}
  </div>
</section>

